---
description: 针对项目中的bug进行精确修复，尽量减少对其他代码的影响
---

## 用户输入

```text
$ARGUMENTS
```

在继续之前，你**必须**考虑用户输入(如果不为空)。用户应该提供bug描述、相关文件路径和可能的修复方向。

## 目标

提供一个结构化的bug修复流程，通过精确的修改定位和最小化的代码变更，修复项目中的bug，同时避免引入新的问题或破坏现有功能。

## 操作约束

**最小化修改原则**：只修改与bug直接相关的代码，避免对其他功能造成影响。

**完整性保证**：确保bug修复是完整的，不仅解决表面症状，还要处理根本原因。

**测试优先**：在进行修复前，确保有适当的测试来验证bug的存在和修复的有效性。

**文档更新**：如果bug修复影响了API或行为，确保更新相应的文档。

## 执行步骤

### 1. 初始化bug修复上下文

从仓库根目录运行一次 `.specify/scripts/bash/check-prerequisites.sh --json` 并解析 JSON 以获取项目环境信息。这将帮助我们了解项目的基本结构和工具链。

### 2. 收集和分析bug信息

- **理解bug**：根据用户输入，明确理解bug的症状、复现步骤和预期行为
- **定位相关文件**：确定可能包含bug的文件和代码区域
- **分析错误日志**：如果有错误日志，分析异常堆栈和错误信息
- **版本历史检查**：查看最近的代码变更，识别可能引入bug的提交

### 3. 创建修复环境

- **创建bug修复分支**：基于当前主分支创建一个专门的bug修复分支
- **设置测试环境**：确保有适当的测试环境可以验证bug和修复
- **备份相关文件**：在修改前备份可能受影响的关键文件

### 4. 实施修复

- **精确修改**：针对已识别的问题进行最小化的代码修改
- **遵循代码风格**：确保修复代码遵循项目现有的代码风格和规范
- **添加必要注释**：为修复添加清晰的注释，说明修复的原因和方法
- **考虑边界情况**：确保修复不会在边界情况下导致新的问题

### 5. 验证修复

- **执行测试**：运行项目的测试套件，确保所有测试通过
- **复现验证**：使用原始的复现步骤，确认bug已被修复
- **回归测试**：执行可能受影响功能的回归测试
- **性能检查**：如果适用，验证修复不会对性能造成负面影响

### 6. 文档和提交

- **更新文档**：如果修复影响了API或功能行为，更新相应的文档
- **编写清晰的提交信息**：提交信息应包含bug描述、修复方法和相关问题引用
- **代码审查准备**：准备修复的代码审查材料，包括问题描述、修复策略和测试结果

## 输出格式

修复过程完成后，输出一个结构化的报告，包括：

1. **Bug摘要**：对bug的简要描述和影响范围
2. **修复概述**：所做的修改概述和修复原理
3. **验证结果**：测试结果和验证方法
4. **潜在风险**：任何可能的风险或需要后续关注的问题
5. **建议的后续步骤**：例如代码审查、部署计划等
